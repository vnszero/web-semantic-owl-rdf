# Identifying Companies Dominating Multiple Metrics

PREFIX : <http://example.org/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

SELECT ?companyName ?cpvDesignation ?marketShare ?contractsCount (COUNT(?competitor) AS ?competesWithCount)
WHERE {
  ?company a :Company ;
           :companyName ?companyName ;
           :cpvDesignation ?cpvDesignation ;
           :marketShareCpvValueNormalizedFormatted ?marketShare ;
           :contractsCount ?contractsCount .

  OPTIONAL {
    ?company :competesWith ?competitor .
  }
}
GROUP BY ?companyName ?cpvDesignation ?marketShare ?contractsCount
HAVING (
  ?marketShare > 40 &&
  xsd:integer(?contractsCount) > 30 &&
  COUNT(?competitor) < 7
)
ORDER BY DESC(?marketShare)